
open Fourever

let t dancer results =

  <h1><%s Dancer.first_name dancer%> <%s Dancer.last_name dancer %></h1>
% results |> Division.Map.iter begin fun div map ->
% if not (Division.equal Division.None div) && not (Role.Map.is_empty map) then begin
  <div class="container">
    <h3><%s Division.to_string div %></h3>
% map |> Role.Map.iter begin fun role l ->
    <h5><%s Role.to_string role %></h5>
    <table class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Event</th>
          <th scope="col">Date</th>
          <th scope="col">Kind</th>
          <th scope="col">Result</th>
          <th scope="col">Points</th>
        </tr>
      </thead>
      <tbody>
% l |> List.iter begin fun (result, competition, event) ->
        <tr>
          <th scope="row">
            <a class="link-primary" href="/event/<%s string_of_int (Fourever.Event.id event) %>">
              <%s Event.name event %>
            </a>
          </th>
          <th>
            <%s Date.to_string (Event.date event) %>
          </th>
          <th>
            <%s Kind.to_string (Competition.kind competition) %>
          </th>
          <th>
            <%s Rank.to_string (Results.rank result) %>
          </th>
          <th>
            <%s string_of_int (Results.points result) %>
          </th>
        </tr>
% end;
      </tbody>
    </table>
% end;
  </div>
% end;
% end;


let list dancer_list =

  <h1>Dancer list</h1>
  <table class="table table-striped my-3">
    <thead>
      <tr>
        <th scope="col">Last Name</th>
        <th scope="col">First Name</th>
        <th scope="col">Division</th>
      </tr>
    </thead>
    <tbody>
%   dancer_list |> List.iter begin fun dancer ->
      <tr>
        <th scope="row">
          <a class="link-primary" href="/dancer/<%s string_of_int @@ Dancer.id dancer %>">
            <%s Dancer.last_name dancer %>
          </a>
        </th>
        <td>
          <%s Dancer.first_name dancer %>
        </td>
        <td>
          <%s Division.to_string @@ Dancer.division dancer %>
        </td>
      </tr>
%   end;
    </tbody>
  </table>

